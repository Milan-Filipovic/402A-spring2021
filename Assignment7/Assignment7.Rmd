---
title: "B402A Assignment 7"
author: "Lillian Chen, Milan Filipovic, Vivian Truong"
date: "5/24/2021"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stringr)
library(haven)
library(gt)
library(tidyr)
library(ggforce) #can be used for large facet grids
```

```{r}

data <- readxl::read_xlsx("./20210521_402a.xlsx", col_names = T, skip = 1)

str(data)

#lalalalalalalalala

dataclean <- data %>% 
  rename(sample = "Sample #",
         patientid = "Patient ID",
         IRI = "IRI Score (â€“,+)",
         visittype = "Visit Type") %>% 
  mutate(across(starts_with("CYTO"),
                ~ dplyr::case_when(
                  str_starts(.x, "<") == T ~ as.numeric(str_sub(.x, 2, -2)),
                  str_starts(.x, ">") == T ~ as.numeric(str_sub(.x, 2, -2)) + 1,
                  str_starts(.x, "1|2|3|4|5|6|7|8|9|0") == T ~ as.numeric(.x)
                )))

```

```{r}
library(data.table)
isidata <- fread(file = "dataclean.csv", header = T, stringsAsFactors = F)
(isi_tble <- tibble(isidata))
```

We begin by visualizing the distribution of cytokine values 



<<<<<<< HEAD


=======

```{r}

isi_tble %>% 
  select(CYTO1:CYTO6) %>% 
  gather() %>% 
  ggplot(aes(value)) + 
 facet_wrap(~ key, nrow = 3, scales = "free") + 
  geom_histogram()

isi_tble %>% 
  select(CYTO7:CYTO12) %>% 
  gather() %>% 
  ggplot(aes(value)) + 
 facet_wrap(~ key, nrow = 3, scales = "free") + 
  geom_histogram()

isi_tble %>% 
  select(CYTO13:CYTO18) %>% 
  gather() %>% 
  ggplot(aes(value)) + 
 facet_wrap(~ key, nrow = 3, scales = "free") + 
  geom_histogram()

isi_tble %>% 
  select(CYTO19:CYTO23) %>% 
  gather() %>% 
  ggplot(aes(value)) + 
 facet_wrap(~ key, nrow = 3, scales = "free") + 
  geom_histogram()

## my attempt to facet in one plot. Does not look good
isi_tble %>% select(starts_with("CYT")) %>%
  gather() %>%
  ggplot(aes(value)) +
facet_wrap(~ key, scales ="free") +
# facet_grid_paginate(~ key, ncol = 3, nrow = 3, page = 2)
  geom_boxplot()
```
# >>>>>>> 2ed165577afd5beda6f141f540a003e5c4b7ce24

The Cytokine distributions are characterized by heavy right skew. 

# <<<<<<< HEAD

=======

Now log transform all Cytokines

```{r}

# >>>>>>> 2ed165577afd5beda6f141f540a003e5c4b7ce24

isi_tble %>% 
  select(CYTO1:CYTO6) %>% 
  gather() %>% 
  ggplot(aes(log(value))) + 
 facet_wrap(~ key, nrow = 3, scales = "free") + 
  geom_histogram() + 
  labs(title = "Log Transformed") +
  xlab("log pg/mL")

isi_tble %>% 
  select(CYTO7:CYTO12) %>% 
  gather() %>% 
  ggplot(aes(log(value))) + 
 facet_wrap(~ key, nrow = 3, scales = "free") + 
  geom_histogram() + 
  labs(title = "Log Transformed") +
  xlab("log pg/mL")

isi_tble %>% 
  select(CYTO13:CYTO18) %>% 
  gather() %>% 
  ggplot(aes(log(value))) + 
 facet_wrap(~ key, nrow = 3, scales = "free") + 
  geom_histogram() + 
  labs(title = "Log Transformed") +
  xlab("log pg/mL")

isi_tble %>% 
  select(CYTO19:CYTO23) %>% 
  gather() %>% 
  ggplot(aes(log(value))) + 
 facet_wrap(~ key, nrow = 3, scales = "free") + 
  geom_histogram() + 
  labs(title = "Log Transformed") +
  xlab("log pg/mL")


```


```{r}

isi_tble %>% 
  select(CYTO1:CYTO6) %>% 
  gather() %>% 
  ggplot(aes(log(value))) + 
 facet_wrap(~ key, nrow = 3, scales = "free") + 
  geom_boxplot() + 
  labs(title = "Log Transformed") +
  xlab("log pg/mL")

isi_tble %>% 
  select(CYTO7:CYTO12) %>% 
  gather() %>% 
  ggplot(aes(log(value))) + 
 facet_wrap(~ key, nrow = 3, scales = "free") + 
  geom_boxplot() + 
  labs(title = "Log Transformed") +
  xlab("log pg/mL")

isi_tble %>% 
  select(CYTO13:CYTO18) %>% 
  gather() %>% 
  ggplot(aes(log(value))) + 
 facet_wrap(~ key, nrow = 3, scales = "free") + 
  geom_boxplot() + 
  labs(title = "Log Transformed") +
  xlab("log pg/mL")

isi_tble %>% 
  select(CYTO19:CYTO23) %>% 
  gather() %>% 
  ggplot(aes(log(value))) + 
 facet_wrap(~ key, nrow = 3, scales = "free") + 
  geom_boxplot() + 
  labs(title = "Log Transformed") +
  xlab("log pg/mL")


```

* Among the log transformed cytokine values, it is seen that that overall normality is improved. 
 + CYTO12 and CYTO 19 appears to have a similar distribution when looking at the histogram, with large left skew and lack of density left of the peak density. 
 + CYTO13 appears as if it may have another peak in the right tail. It is right skewed. 
* CYTO 15 appears to have several outliers in the higher range.
* CYTO16 appears right skewed. 
* CYTO18 appears to have lower outliers. 
* CYTO17 has many values below level of detection, therefore the transformation did not affect overall normality. 
* CYTO21 appears to have a large right skew, though it should be noted that many values were below level of detection in CYTO 21. 


```{r logistic reg main effects}
#all cytokine values transformed with log2

#main effects
logdataclean <- dataclean %>% 
  mutate(across(starts_with("CYTO"), log2))
main.mod <- glm(IRI ~ . -sample -patientid -Inflammation -Necrosis -visittype, data = logdataclean, family = "binomial")
summary(main.mod)

# main effects leaving out visittype and checking for significance within each visit
podata <- logdataclean %>% filter(visittype == "PO") %>% 
  mutate(visittype = NULL)
po.mod <- glm(IRI ~ . -sample -patientid -Inflammation -Necrosis, data = podata, family = "binomial")
summary(po.mod)

lfdata <- logdataclean %>% filter(visittype == "LF") %>%
  mutate(visittype = NULL) 
lf.mod <- glm(IRI ~ . -sample -patientid -Inflammation -Necrosis, data = lfdata, family = "binomial")
summary(lf.mod)

w1data <- logdataclean %>% filter(visittype == "W1") %>%
  mutate(visittype = NULL)
w1.mod <- glm(IRI ~ . -sample -patientid -Inflammation -Necrosis, data = w1data, family = "binomial")
summary(w1.mod)

# main effects for changes from one visit to the next
prefix <- "CYTO"
suffix <- seq(1:23)
values <- paste(prefix, suffix, sep = "")

diffnames <- NULL
diffnames <- c(diffnames, paste(values, "diffs", sep = "."))

# wide data
iriwidedata <- logdataclean %>% 
  mutate(sample = NULL) %>% 
  pivot_wider (names_from = visittype, names_sep = ".", values_from = all_of(values))

# cyto change data
irichangedata <- logdataclean
setDT(irichangedata)[, c(diffnames) := lapply(.SD, 
      function(x) x-shift(x, fill=x[1L])), by = patientid, .SDcols=7:29]

# subset only change vars for model
changesubset <- irichangedata %>% 
  select(-Inflammation, -Necrosis, -visittype, -(CYTO1:CYTO23)) %>% 
  group_by(patientid) %>% 
  slice(2:n())

CYTObaseline <- logdataclean %>% 
  filter(visittype == "PO") %>% 
  select(patientid, CYTO1:CYTO23)

changesubsetbaseline <- left_join(changesubset, CYTObaseline, by = "patientid")

diff1subset <- changesubset %>% 
  group_by(patientid) %>% 
  slice(1)

diff2subset <- changesubset %>% 
  group_by(patientid) %>% 
  slice(2)


# change model
changemain.mod <- glm(IRI ~ . -sample -patientid, data = changesubset, family = "binomial")
summary(changemain.mod)
step(changemain.mod)

#Call:  glm(formula = IRI ~ 1, family = "binomial", data = changesubset)
# 
# Coefficients:
# (Intercept)  
#     -0.3228  
# 
# Degrees of Freedom: 199 Total (i.e. Null);  199 Residual
# Null Deviance:	    272.1 
# Residual Deviance: 272.1 	AIC: 274.1

# change model
changemainbase.mod <- glm(IRI ~ . -sample -patientid, data = changesubsetbaseline, family = "binomial")
summary(changemainbase.mod)
step(changemainbase.mod)

# glm(formula = IRI ~ CYTO9.diffs + CYTO18.diffs + CYTO22.diffs + 
#     CYTO1 + CYTO3 + CYTO4 + CYTO15 + CYTO16 + CYTO17 + CYTO21 + 
#     CYTO22 + CYTO23, family = "binomial", data = changesubsetbaseline)
# 
# Coefficients:
#  (Intercept)   CYTO9.diffs  CYTO18.diffs  CYTO22.diffs         CYTO1         CYTO3         CYTO4        CYTO15        CYTO16        CYTO17  
#      -2.1782       -0.2740        0.1561        0.3408        0.4156       -0.3627       -0.1527       -0.7015        0.5859       -0.8471  
#       CYTO21        CYTO22        CYTO23  
#      -0.2697        0.4244        0.8210  
# 
# Degrees of Freedom: 199 Total (i.e. Null);  187 Residual
# Null Deviance:	    272.1 
# Residual Deviance: 237.6 	AIC: 263.6

# only change from po to lf
changemain1.mod <- glm(IRI ~ . -sample -patientid, data = diff1subset, family = "binomial")
summary(changemain1.mod)
step(changemain1.mod)
# glm(formula = IRI ~ CYTO2.diffs + CYTO3.diffs + CYTO4.diffs + 
#     CYTO9.diffs + CYTO10.diffs + CYTO13.diffs + CYTO14.diffs + 
#     CYTO18.diffs + CYTO19.diffs + CYTO23.diffs, family = "binomial", 
#     data = diff1subset)
# 
# Coefficients:
#  (Intercept)   CYTO2.diffs   CYTO3.diffs   CYTO4.diffs   CYTO9.diffs  CYTO10.diffs  CYTO13.diffs  CYTO14.diffs  CYTO18.diffs  CYTO19.diffs  
#      -1.4014       -0.4890        0.5601        0.4316        1.5653        0.5286        0.2369       -0.7711        0.2313       -1.2389  
# CYTO23.diffs  
#      -0.6864  
# 
# Degrees of Freedom: 99 Total (i.e. Null);  89 Residual
# Null Deviance:	    136.1 
# Residual Deviance: 115.9 	AIC: 137.9

# only change from lf to w1
changemain2.mod <- glm(IRI ~ . -sample -patientid, data = diff2subset, family = "binomial")
summary(changemain2.mod)
step(changemain2.mod)
# glm(formula = IRI ~ CYTO2.diffs + CYTO4.diffs + CYTO9.diffs + 
#     CYTO13.diffs + CYTO14.diffs + CYTO16.diffs, family = "binomial", 
#     data = diff2subset)
# 
# Coefficients:
#  (Intercept)   CYTO2.diffs   CYTO4.diffs   CYTO9.diffs  CYTO13.diffs  CYTO14.diffs  CYTO16.diffs  
#      -1.4135        0.3515       -0.2009       -0.9077       -0.2089        0.6576        0.4266  
# 
# Degrees of Freedom: 99 Total (i.e. Null);  93 Residual
# Null Deviance:	    136.1 
# Residual Deviance: 114.2 	AIC: 128.2


# random effects - didn't work

# library(lme4)
# CYTOchange <- names(changesubset[4:26])
# eqn <- as.formula(paste("IRI ~ (1 | patientid)", 
#                         paste(CYTOchange, collapse = " + "), sep = "+"))
# randomeffects.changemod <- glmer(eqn, data = changesubset, family = "binomial", 
#                                  nAGQ = 30, control = glmerControl(optimizer= "bobyqa"))
# summary(randomeffects.changemod)
```


```{r logistic reg main effects without cyto17}

main.mod.17 <- glm(IRI ~ . -sample -patientid -Inflammation -Necrosis -visittype -CYTO17, data = logdataclean, family = "binomial")
summary(main.mod.17)
# CYTO1 0.1
# CYTO16 0.1
# CYTO18 0.05
# CYTO22 0.05
main.table <- main.mod.17 %>% 
  tbl_regression(include = c("CYTO1", "CYTO16", "CYTO18", "CYTO22"), intercept = T) %>% 
  bold_p(t = 0.1)

# main effects leaving out visittype and checking for significance within each visit
po.mod.17 <- glm(IRI ~ . -sample -patientid -Inflammation -Necrosis -CYTO17, data = podata, family = "binomial")
summary(po.mod.17)
# CYTO3 0.1
# CYTO15 0.1
# CYTO16 0.1
# CYTO23 0.1
po.table <- po.mod.17 %>% 
  tbl_regression(include = c("CYTO3", "CYTO15", "CYTO16", "CYTO23"), intercept = T) %>% 
  bold_p(t = 0.1)

lf.mod.17 <- glm(IRI ~ . -sample -patientid -Inflammation -Necrosis -CYTO17, data = lfdata, family = "binomial")
summary(lf.mod.17)
# CYTO1 0.05
# CYTO2 0.05
# CYTO11 0.05
# CYTO13 0.1
# CYTO14 0.1
lf.table <- lf.mod.17 %>% 
  tbl_regression(include = c("CYTO1", "CYTO2", "CYTO11", "CYTO13", "CYTO14"), intercept = T) %>% 
  bold_p(t = 0.1)

w1.mod.17 <- glm(IRI ~ . -sample -patientid -Inflammation -Necrosis -CYTO17, data = w1data, family = "binomial")
summary(w1.mod.17)
# CYTO9 0.05
# CYTO13 0.1
# CYTO18 0.1
# CYTO22 0.05
w1.table <- w1.mod.17 %>% 
  tbl_regression(include = c("CYTO9", "CYTO13", "CYTO18", "CYTO22"), intercept = T) %>% 
  bold_p(t = 0.1)

# change model
changemain.mod.17 <- glm(IRI ~ . -sample -patientid -CYTO17.diffs, data = changesubset, family = "binomial")
summary(changemain.mod.17)
# CYTO9.diffs 0.1
changemain.table <- changemain.mod.17 %>% 
  tbl_regression(include = c("CYTO9.diffs"), intercept = T) %>% 
  bold_p(t = 0.1)

step(changemain.mod.17)
# yields null model, not significant

# change model
changemainbase.mod.17 <- glm(IRI ~ . -sample -patientid -CYTO17.diffs -CYTO17, data = changesubsetbaseline, family = "binomial")
summary(changemainbase.mod.17)
# CYTO9.diffs 0.1
# CYTO1 0.1
# CYTO3 0.05
# CYTO15 0.05
# CYTO16 0.05
# CYTO23 0.05
changemainbase.table <- changemainbase.mod.17 %>% 
  tbl_regression(include = c("CYTO9.diffs", "CYTO1", "CYTO3", "CYTO15",
                             "CYTO16", "CYTO23"), intercept = T) %>% 
  bold_p(t = 0.1)

step(changemainbase.mod.17)

# glm(formula = IRI ~ CYTO16.diffs + CYTO1 + CYTO3 + CYTO15 + CYTO16 + 
#     CYTO22 + CYTO23, family = "binomial", data = changesubsetbaseline)
# 
# Coefficients:
#  (Intercept)  CYTO16.diffs         CYTO1         CYTO3        CYTO15        CYTO16        CYTO22        CYTO23  
#      -2.5005        0.2666        0.3085       -0.2818       -0.7830        0.5465        0.2642        0.6724  
# 
# Degrees of Freedom: 199 Total (i.e. Null);  192 Residual
# Null Deviance:	    272.1 
# Residual Deviance: 247.3 	AIC: 263.3

# only change from po to lf
changemain1.mod.17 <- glm(IRI ~ . -sample -patientid -CYTO17.diffs, data = diff1subset, family = "binomial")
summary(changemain1.mod.17)
# Intercept 0.05 down
# CYTO2.diffs 0.1 down
# CYTO3.diffs 0.1  up
# CYTO4.diffs 0.05 up
# CYTO9.diffs 0.05 up
# CYTO10.diffs 0.1 up
# CYTO14.diffs 0.05 down
# CYTO19.diffs 0.1 down


library(gtsummary)
changemain1.table <- changemain1.mod.17 %>% 
  tbl_regression(include = c("CYTO2.diffs", "CYTO3.diffs",
                             "CYTO4.diffs", "CYTO9.diffs", "CYTO10.diffs",
                             "CYTO14.diffs", "CYTO19.diffs"), intercept = T) %>% 
  bold_p(t = 0.1)

step(changemain1.mod.17)
#glm(formula = IRI ~ CYTO2.diffs + CYTO3.diffs + CYTO4.diffs + 
#     CYTO9.diffs + CYTO10.diffs + CYTO13.diffs + CYTO14.diffs + 
#     CYTO18.diffs + CYTO19.diffs + CYTO23.diffs, family = "binomial", 
#     data = diff1subset)
# 
# Coefficients:
#  (Intercept)   CYTO2.diffs   CYTO3.diffs   CYTO4.diffs   CYTO9.diffs  CYTO10.diffs  CYTO13.diffs  CYTO14.diffs  CYTO18.diffs  CYTO19.diffs  
#      -1.4014       -0.4890        0.5601        0.4316        1.5653        0.5286        0.2369       -0.7711        0.2313       -1.2389  
# CYTO23.diffs  
#      -0.6864  
# 
# Degrees of Freedom: 99 Total (i.e. Null);  89 Residual
# Null Deviance:	    136.1 
# Residual Deviance: 115.9 	AIC: 137.9

# only change from lf to w1
changemain2.mod.17 <- glm(IRI ~ . -sample -patientid -CYTO17.diffs, data = diff2subset, family = "binomial")
summary(changemain2.mod.17)
# CYTO2.diffs 0.1 up
# CYTO9.diffs 0.01 down
changemain2.table <- changemain2.mod.17 %>% 
  tbl_regression(include = c("CYTO2.diffs", "CYTO9.diffs"), intercept = T) %>% 
  bold_p(t = 0.1)

step(changemain2.mod.17)
# glm(formula = IRI ~ CYTO2.diffs + CYTO4.diffs + CYTO9.diffs + 
#     CYTO13.diffs + CYTO14.diffs + CYTO16.diffs, family = "binomial", 
#     data = diff2subset)
# 
# Coefficients:
#  (Intercept)   CYTO2.diffs   CYTO4.diffs   CYTO9.diffs  CYTO13.diffs  CYTO14.diffs  CYTO16.diffs  
#      -1.4135        0.3515       -0.2009       -0.9077       -0.2089        0.6576        0.4266  
# 
# Degrees of Freedom: 99 Total (i.e. Null);  93 Residual
# Null Deviance:	    136.1 
# Residual Deviance: 114.2 	AIC: 128.2
```
```{r logistic reg step interactions no 17}

# took significant predictors at 0.1 level and included them in this model to check for interactions
# then take step function and report final step
int.mod.17 <- glm(IRI ~ (CYTO1 + CYTO16 + CYTO18 + CYTO22)^2, data = logdataclean, family = "binomial")
summary(int.mod.17)
stepint.mod.17 <- step(int.mod.17)
stepint.table <- stepint.mod.17 %>% 
  tbl_regression(intercept = T) %>% 
  bold_p(t = 0.1)

# main effects leaving out visittype and checking for significance within each visit
# took significant predictors at 0.1 level and included them in this model to check for interactions
# then take step function and report final step
point.mod.17 <- glm(IRI ~ (CYTO3 + CYTO15 + CYTO16 + CYTO23)^2, data = podata, family = "binomial")
summary(point.mod.17)
steppoint.mod.17 <- step(point.mod.17)
steppoint.table <- steppoint.mod.17 %>% 
  tbl_regression(intercept = T) %>% 
  bold_p(t = 0.1)


# took significant predictors at 0.1 level and included them in this model to check for interactions
# then take step function and report final step
lfint.mod.17 <- glm(IRI ~ (CYTO1 + CYTO2 + CYTO11 + CYTO13 + CYTO14)^2, data = lfdata, family = "binomial")
summary(lfint.mod.17)
steplfint.mod.17 <- step(lfint.mod.17)
steplfint.table <- steplfint.mod.17 %>% 
  tbl_regression(intercept = T) %>% 
  bold_p(t = 0.1)

# took significant predictors at 0.1 level and included them in this model to check for interactions
# then take step function and report final step
w1int.mod.17 <- glm(IRI ~ (CYTO9 + CYTO13 + CYTO18 + CYTO22)^2, data = w1data, family = "binomial")
summary(w1int.mod.17)
stepw1int.mod.17 <- step(w1int.mod.17)
stepw1int.table <- stepw1int.mod.17 %>% 
  tbl_regression(intercept = T) %>% 
  bold_p(t = 0.1)


# change model, note: does not use output of step from main effects bc that was just null model
# note: does not converge
# changeint.mod.17 <- glm(IRI ~ (. -sample -patientid -CYTO17.diffs)^2, data = changesubset, family = "binomial")
# summary(changeint.mod.17)
# stepint.mod <- step(changeint.mod.17)
# stepint.table <- stepint.mod %>% 
#   tbl_regression(intercept = T)

# change model
changeintbase.mod.17 <- glm(formula = IRI ~ (CYTO16.diffs + CYTO1 + CYTO3 + CYTO15 + CYTO16 + 
     CYTO22 + CYTO23)^2, family = "binomial", data = changesubsetbaseline)
summary(changeintbase.mod.17)

stepintbase.mod <- step(changeintbase.mod.17)
stepintbase.table <- stepintbase.mod %>% 
  tbl_regression(intercept = T) %>% 
  bold_p(t = 0.1)

# only change from po to lf note: does not converge
# changeint1.mod.17 <- glm(formula = IRI ~ (CYTO2.diffs + CYTO3.diffs + CYTO4.diffs + 
#      CYTO9.diffs + CYTO10.diffs + CYTO13.diffs + CYTO14.diffs + 
#      CYTO18.diffs + CYTO19.diffs + CYTO23.diffs)^2, family = "binomial", 
#      data = diff1subset)
# summary(changeint1.mod.17)
# 
# stepint1.mod <- step(changeint1.mod.17)
# stepint1.table <- stepint1.mod %>% 
#   tbl_regression(intercept = T)


# only change from lf to w1
changeint2.mod.17 <- glm(formula = IRI ~ (CYTO2.diffs + CYTO4.diffs + CYTO9.diffs + 
CYTO13.diffs + CYTO14.diffs + CYTO16.diffs)^2, family = "binomial", 
data = diff2subset)
summary(changeint2.mod.17)

stepint2.mod <- step(changeint2.mod.17)
stepint2.table <- stepint2.mod %>% 
  tbl_regression(intercept = T) %>%
  bold_p(t = 0.1)



```


```{r corr plot}
library(ggcorrplot)
corr.change <- round(cor(changesubset[3:49]), 3)
pcorr.change <- round(cor_pmat(changesubset[3:49]), 3)

corr.diff1 <- round(cor(diff1subset[3:26]), 3)
pcorr.diff1 <- round(cor_pmat(diff1subset[3:26]), 3)

corr.diff2 <- round(cor(diff2subset[3:26]), 3)
pcorr.diff2 <- round(cor_pmat(diff2subset[3:26]), 3)


ggcorrplot(corr.change, type = "lower")
ggcorrplot(corr.diff1, type = "lower")
ggcorrplot(corr.diff2, type = "lower")

# hierarchical clustering or something i don't know
ggcorrplot(corr.diff1, hc.order = T, outline.col = "white", type = "lower")
ggcorrplot(corr.diff2, hc.order = T, outline.col = "white", type = "lower")

# hierarchical clustering + leaving insignificant correlation blank
ggcorrplot(corr.diff1, p.mat = pcorr.diff1, hc.order = T, 
           outline.col = "white", type = "lower", insig = "blank")
ggcorrplot(corr.diff2, p.mat = pcorr.diff2, hc.order = T, 
           outline.col = "white", type = "lower", insig = "blank")
```


summary:

* overall log data : cyto 1, 17, 18, 22
* overall log po : none significant
* overall log lf : cyto 1, 2, 14
* overall log w1: cyto 22

```{r Research Question 2}

xtabs(~ Inflammation, data = dataclean)
xtabs(~ Necrosis, data = dataclean)

# split outcomes (Inflammation or Necrosis Score) with 0-1 vs 2+ as -/+
# try two types of models: ordered factor outcome and binary outcome (try both)
# =======
```

